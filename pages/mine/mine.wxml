<!-- 防止弹窗穿透 -->
<page-meta page-style="overflow: {{showPopup ? 'hidden' : 'visible'}}" />
<!-- 我的页面 -->
<view class="view-page-mine">
  <!-- 顶部栏 -->
  <view class="view-top-box">
    <block wx:if="{{userAvatar != ''}}">
      <image class="img-user-avatar" src="{{userAvatar}}"></image>
    </block>
    <block wx:else>
      <open-data class="img-user-avatar" type="userAvatarUrl"></open-data>
    </block>
    <block wx:if="{{userNickname != ''}}">
      <text class="text-user-nickName">{{userNickname}}</text>
    </block>
    <block wx:else>
      <open-data class="text-user-nickName" type="userNickName"></open-data>
    </block>
  </view>
  <!-- 功能栏 -->
  <view class="view-function-box">
    <!-- 意见反馈 -->
    <view class="view-function" bindtap="onClickFeedback">
      <image class="img-function" src="../../images/img_feedback.png"></image>
      <text class="text-function">意见反馈</text>
    </view>
    <!-- 联系客服 -->
    <view class="view-function" style="border-top: 1rpx solid #E4E4E4;">
      <image class="img-function" src="../../images/img_contact.png"></image>
      <text class="text-function">联系客服</text>
      <button class="btn-function" open-type="contact"></button>
    </view>
    <!-- 设置头像 -->
    <view class="view-function" bindtap="onClickSetAvatar" style="border-top: 1rpx solid #E4E4E4;">
      <image class="img-function" src="../../images/img_avatar.png"></image>
      <text class="text-function">设置头像</text>
    </view>
    <!-- 设置昵称 -->
    <view class="view-function" bindtap="onClickSetNickname" style="border-top: 1rpx solid #E4E4E4;">
      <image class="img-function" src="../../images/img_nickname.png"></image>
      <text class="text-function">设置昵称</text>
    </view>
    <!-- 设置公告 -->
    <block wx:if="{{showSetNotice}}">
      <view class="view-function" bindtap="onClickSetNotice" style="border-top: 1rpx solid #E4E4E4;">
        <image class="img-function-notice" src="../../images/img_notice_1.png"></image>
        <text class="text-function">设置公告</text>
      </view>
    </block>
    <!-- 分享小程序 -->
    <view class="view-function" style="border-top: 1rpx solid #E4E4E4;">
      <image class="img-function" src="../../images/img_share.png"></image>
      <text class="text-function">分享回忆录</text>
      <button class="btn-function" open-type="share"></button>
    </view>
    <!-- 关于小程序 -->
    <view class="view-function" bindtap="onClickAbout" style="border-top: 1rpx solid #E4E4E4;">
      <image class="img-function" src="../../images/img_about.png"></image>
      <text class="text-function">关于回忆录</text>
    </view>
  </view>
  <block wx:if="{{showFeedback}}">
    <!-- 意见反馈页的蒙版 -->
    <view class="view-mask-box"></view>
    <!-- 意见反馈页 -->
    <view class="view-feedback-box">
      <text class="text-viewName">意见反馈</text>
      <!-- 意见反馈图片栏 -->
      <view class="view-feedback-localPicPathList">
        <block wx:if="{{localPicPathList.length}}">
          <block wx:for-items="{{localPicPathList}}" wx:key="index">
            <view class="view-feedback-picCell" style="margin-left:{{index == 0 ? '0' : '10rpx'}}">
              <image class="img-feedback-picCell" src="{{item}}" bindtap="onPreviewAddPic" data-index="{{index}}"></image>
              <image class="img-feedback-deletePicCell" src="../../images/img_delete.png" bindtap="onClickDeletePic" data-index="{{index}}"></image>
            </view>
          </block>
        </block>
        <block wx:if="{{localPicPathList.length < 5}}">
          <!-- 添加图片按钮 -->
          <view class="view-feedback-addPic" style="margin-left:{{localPicPathList.length == 0 ? '0' : '10rpx'}}" bindtap="onClickAddPic">
            <image class="img-feedback-dottedBox" src="../../images/img_dotted_box.png"></image>
            <image class="img-feedback-picIcon" src="../../images/img_add_picture.png"></image>
            <text>添加图片</text>
          </view>
        </block>
      </view>
      <!-- 意见反馈内容栏 -->
      <view class="view-feedback-content">
        <textarea class="textarea-feedback-content" maxlength="-1" placeholder="请尽可能详细的描述您要反馈的问题或建议..." bindinput="feedbackContent" placeholder-style="color: rgba(70,123,115,0.5);" disable-default-padding='true' cursor-spacing="30"></textarea>
      </view>
      <image class="img-feedback-record" src="../../images/img_upload.png" bindtap="onClickUploadFeedback"></image>
      <image class="img-feedback-back" src="../../images/img_back.png" bindtap="onClickBackMine"></image>
    </view>
  </block>
  <block wx:if="{{showAboutSelf}}">
    <!-- 关于回忆录的蒙版 -->
    <view class="view-mask-box" bindtap="onClickAboutSelfMask"></view>
    <view class="view-aboutSelf-box">
      <text class="text-viewName">关于回忆录</text>
      <text class="text-aboutSelf">{{aboutSelfContent}}</text>
      <image class="img-praise" src="{{praiseState ? '../../images/img_praise.png' : '../../images/img_no_praise.png'}}" bindtap="onClickPraise"></image>
      <text class="text-praiseSum">{{praiseSum}}</text>
    </view>
  </block>
  <block wx:if="{{showSetNoticeView}}">
    <!-- 设置公告的蒙版 -->
    <view class="view-mask-box" bindtap="onClickSetNoticeMask"></view>
    <view class="view-set-box">
      <text class="text-viewName">设置公告</text>
      <view class="view-set-content">
        <input class="input-set-content" maxlength="40" placeholder="公告内容..." placeholder-style="color: rgba(70,123,115,0.5);" bindinput="setNoticeContent" />
      </view>
      <image class="img-set-update" src="../../images/img_upload.png" bindtap="onClickUpdateNotice"></image>
    </view>
  </block>
  <block wx:if="{{showSetNicknameView}}">
    <!-- 设置昵称的蒙版 -->
    <view class="view-mask-box" bindtap="onClickSetNicknameMask"></view>
    <view class="view-set-box">
      <text class="text-viewName">设置昵称</text>
      <view class="view-set-content">
        <input class="input-set-content" maxlength="10" placeholder="请输入昵称..." placeholder-style="color: rgba(70,123,115,0.5);" bindinput="setNicknameContent" />
      </view>
      <image class="img-set-update" src="../../images/img_upload.png" bindtap="onClickUpdateNickname"></image>
    </view>
  </block>
</view>